library(tidyverse)
source("R/utils.R")

ability_to_prepare_indicators <-
  susceptibility_indicators <-
  load_indicators(
    path = "data/vulnerability/disasters-emergencies/flooding/2011-census/england/ability-to-prepare",
    key = "lsoa_code",
    pattern = "-lsoa.rds"
  )

ability_to_recover_indicators <-
  susceptibility_indicators <-
  load_indicators(
    path = "data/vulnerability/disasters-emergencies/flooding/2011-census/england/ability-to-recover",
    key = "lsoa_code",
    pattern = "-lsoa.rds"
  )

ability_to_respond_indicators <-
  susceptibility_indicators <-
  load_indicators(
    path = "data/vulnerability/disasters-emergencies/flooding/2011-census/england/ability-to-respond",
    key = "lsoa_code",
    pattern = "-lsoa.rds"
  )

community_support_indicators <-
  susceptibility_indicators <-
  load_indicators(
    path = "data/vulnerability/disasters-emergencies/flooding/2011-census/england/community-support",
    key = "lsoa_code",
    pattern = "-lsoa.rds"
  )

susceptibility_indicators <-
  load_indicators(
    path = "data/vulnerability/disasters-emergencies/flooding/2011-census/england/susceptibility",
    key = "lsoa_code",
    pattern = "-lsoa.rds"
  )

all_indicators <- ability_to_prepare_indicators |> 
  left_join(ability_to_recover_indicators, by = "lsoa_code") |> 
  left_join(ability_to_respond_indicators, by = "lsoa_code") |> 
  left_join(community_support_indicators, by = "lsoa_code") |> 
  left_join(susceptibility_indicators, by = "lsoa_code") |> 
  rename(lsoa11_code = lsoa_code)

write_csv(all_indicators, "data/vulnerability/disasters-emergencies/flooding/2011-census/england/flood-vulnerability-index-all-indicators.csv")
